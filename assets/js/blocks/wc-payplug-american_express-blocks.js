(()=>{"use strict";var e={n:t=>{var n=t&&t.__esModule?()=>t.default:()=>t;return e.d(n,{a:n}),n},d:(t,n)=>{for(var a in n)e.o(n,a)&&!e.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:n[a]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.wp.element,n=window.wp.i18n,a=window.wc.wcBlocksRegistry,s=window.wp.htmlEntities,o=window.wc.wcSettings,r=window.React,c=window.wp.data,i=window.jQuery;var p=e.n(i);const l=(0,o.getSetting)("payplug_data",{}),w=((0,o.getSetting)("payplug_data",{}),({props:e})=>{const{eventRegistration:n,emitResponse:a,shouldSavePayment:s}=e,{onPaymentSetup:o,onCheckoutSuccess:i}=n,{CHECKOUT_STORE_KEY:w}=window.wc.wcBlocksData,u=(0,c.useSelect)((e=>e(w).getOrderId()));let d;return(0,r.useEffect)((()=>{const e=o((async()=>(await((e,t)=>{const n={order_id:t,"woocommerce-process-checkout-nonce":l.wp_nonce,gateway:"payplug"};return new Promise(((e,t)=>p().ajax({type:"POST",data:n,url:l.payplug_create_intent_payment}).success((function(t){e(t)})).error((function(e){t(e)}))))})(0,u).then((async e=>{d=e})),{type:"success"})));return()=>{e()}}),[s,o,a.noticeContexts.PAYMENTS,a.responseTypes.ERROR,a.responseTypes.SUCCESS]),(0,r.useEffect)((()=>{const e=i((async({processingResponse:{paymentDetails:e}})=>{await function(e){return new Promise((async(t,n)=>{try{window.redirection_url=e.data.cancel||!1,await Payplug.showPayment(e.data.redirect)}catch(e){n(e)}}))}(d).then((()=>({type:"error",message:"Timeout",messageContext:a.noticeContexts.PAYMENTS})))}));return()=>{e()}}),[i]),(0,t.createElement)(t.Fragment,null)}),u=(0,o.getSetting)("american_express_data",{}),d=(0,n.__)("Gateway method title","payplug"),m=(0,s.decodeEntities)(u?.title)||d,y=e=>!0===u?.popup?(console.log("popup"),(0,t.createElement)(w,{settings:u,props:e})):window.wp.htmlEntities.decodeEntities(u?.description||""),g=()=>(0,t.createElement)("img",{src:u?.icon.src,alt:u?.icon.icon_alt,className:"payplug-payment-icon",style:{float:"right"}}),E={name:"american_express",label:(0,t.createElement)((()=>(0,t.createElement)("span",{style:{width:"100%"}},m,(0,t.createElement)(g,null))),null),content:(0,t.createElement)(y,null),edit:(0,t.createElement)(y,null),canMakePayment:()=>!0,ariaLabel:m,supports:{features:u.supports}};(0,a.registerPaymentMethod)(E)})();