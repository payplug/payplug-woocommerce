name: Payplug Woocommerce CI
on: [ push ]
jobs:
  Generate-Zip-File:
    name: 1) Generate-Zip-File
    runs-on: ubuntu-latest
    steps:
      - name: Check out repository code ${{ github.workflow }}
        uses: actions/checkout@v3
      - name: Start the zip generation
        run: ./bin/build-plugin-zip.sh qa
      - uses: actions/upload-artifact@v3
        with:
          name: payplug-woocommerce.zip
          path: /home/runner/work/payplug-woocommerce/payplug-woocommerce.zip
      - run: echo "üçè This job's status is ${{ job.status }}."
  Check-PHP-Compatibility:
    name: 2) Check PHP Compatibility
    runs-on: ubuntu-latest
    steps:
      - name: Check out repository code ${{ github.workflow }}
        uses: actions/checkout@v3
      - name: Install composer dependencies
        uses: ramsey/composer-install@v2
        with:
          composer-options: "--ignore-platform-reqs"
      - name: Install "PHPCompatibility" coding standard
        run: vendor/bin/phpcs --config-set installed_paths vendor/phpcompatibility/php-compatibility
      - name: create report-5.3.txt
        run: touch /home/runner/work/payplug-woocommerce/report-5.3.txt
      - name: Test php version 5.3
        run: vendor/bin/phpcs --colors -s --report=summary  ./src/ --standard=PHPCompatibility --runtime-set testVersion 5.3
      - name: Print Test php version 5.3
        run: vendor/bin/phpcs --colors --report=code ./src/ --standard=PHPCompatibility --runtime-set testVersion 5.3 --report-file=/report-5.3.txt

      - uses: actions/upload-artifact@v3
        with:
          name: report-5.3.txt
          path: /home/runner/work/payplug-woocommerce/report-5.3.txt

      - run: echo "üçè This job's status is ${{ job.status }}."
